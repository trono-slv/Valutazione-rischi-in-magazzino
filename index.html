<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Rischi Specifici in Magazzino - Dott. Salvatore Trono</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        .progress-bar {
            transition: width 0.3s ease-out;
        }
        
        .minimap-item {
            transition: all 0.2s ease;
        }
        
        .minimap-item:hover {
            transform: scale(1.1);
        }
        
        .btn-primary {
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .option-button {
            transition: all 0.2s ease;
        }
        
        .option-button:hover {
            transform: translateX(5px);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .timer-warning {
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Welcome Screen -->
    <div id="welcomeScreen" class="container mx-auto px-4 py-8 max-w-4xl">
        <div class="bg-white rounded-2xl shadow-2xl p-8 fade-in">
            <!-- Header -->
            <div class="text-center mb-8">
                <div class="text-6xl mb-4">üéì</div>
                <h1 class="text-4xl font-bold text-gray-800 mb-2">
                    Quiz Rischi Specifici in Magazzino
                </h1>
                <div class="h-1 w-32 bg-gradient-to-r from-blue-500 to-purple-600 mx-auto rounded-full"></div>
            </div>

            <!-- Autore -->
            <div class="mb-8 p-6 bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl border-l-4 border-blue-500">
                <div class="flex items-start gap-3">
                    <span class="text-3xl">üë®‚Äçüè´</span>
                    <div>
                        <h3 class="font-bold text-gray-800 text-lg mb-1">A cura di:</h3>
                        <p class="text-gray-700 font-semibold">Dott. Salvatore Trono</p>
                        <p class="text-gray-600 text-sm">Formatore ed Esperto SSL</p>
                    </div>
                </div>
            </div>

            <!-- Link Teoria -->
            <div class="mb-8">
                <a href="https://trono-slv.github.io/Valutazione-dei-rischi-in-magazzino/" 
                   target="_blank"
                   class="block p-4 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 text-center font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-1">
                    <span class="text-xl mr-2">üìö</span>
                    Vai alla Teoria: Valutazione dei Rischi in Magazzino
                    <span class="text-xl ml-2">‚Üí</span>
                </a>
            </div>

            <!-- Istruzioni -->
            <div class="mb-8 p-6 bg-blue-50 rounded-xl border border-blue-200">
                <h3 class="font-bold text-gray-800 mb-4 flex items-center gap-2 text-lg">
                    <span class="text-2xl">üìã</span> ISTRUZIONI
                </h3>
                <ul class="space-y-3 text-gray-700">
                    <li class="flex items-start gap-3">
                        <span class="text-blue-600 font-bold">‚Ä¢</span>
                        <span>Il test √® composto da <strong>15 domande</strong> estratte casualmente da un database di 128 quesiti basati sul <strong>D.Lgs. 81/2008</strong></span>
                    </li>
                    <li class="flex items-start gap-3">
                        <span class="text-blue-600 font-bold">‚Ä¢</span>
                        <span>Tempo disponibile: <strong>20 minuti totali</strong> (timer visibile in alto)</span>
                    </li>
                    <li class="flex items-start gap-3">
                        <span class="text-blue-600 font-bold">‚Ä¢</span>
                        <span>Soglia di superamento: <strong>70%</strong> (minimo 11 risposte corrette su 15)</span>
                    </li>
                    <li class="flex items-start gap-3">
                        <span class="text-blue-600 font-bold">‚Ä¢</span>
                        <span><strong>Click sulla risposta = avanzamento immediato</strong> alla domanda successiva (nessun feedback visivo)</span>
                    </li>
                    <li class="flex items-start gap-3">
                        <span class="text-blue-600 font-bold">‚Ä¢</span>
                        <span>Usa la <strong>minimap laterale</strong> per navigare tra le domande gi√† visualizzate</span>
                    </li>
                    <li class="flex items-start gap-3">
                        <span class="text-blue-600 font-bold">‚Ä¢</span>
                        <span>Al termine del tempo o dopo l'ultima risposta, vedrai il <strong>riepilogo completo</strong> con spiegazioni</span>
                    </li>
                </ul>
            </div>

            <!-- Disclaimer -->
            <div class="mb-8 p-6 bg-yellow-50 rounded-xl border-l-4 border-yellow-500">
                <h3 class="font-bold text-gray-800 mb-3 flex items-center gap-2 text-lg">
                    <span class="text-2xl">‚ö†Ô∏è</span> DISCLAIMER LEGALE
                </h3>
                <div class="text-sm text-gray-700 space-y-2">
                    <p>
                        <strong>Questo quiz √® uno strumento didattico-informativo non ufficiale.</strong>
                    </p>
                    <p>
                        Le domande sono elaborate sulla base del <strong>D.Lgs. 81/2008</strong> (Testo Unico sulla Sicurezza sul Lavoro) e dell'<strong>Accordo Stato-Regioni del 21/12/2011</strong>, ma questo test <strong>NON sostituisce</strong>:
                    </p>
                    <ul class="list-disc list-inside space-y-1 ml-4">
                        <li>La formazione obbligatoria prevista dalla normativa vigente</li>
                        <li>Il Documento di Valutazione dei Rischi (DVR) aziendale</li>
                        <li>Le valutazioni specifiche dei rischi del proprio ambiente di lavoro</li>
                    </ul>
                    <p class="mt-3">
                        Per corsi di formazione <strong>validi ai fini di legge</strong>, rivolgersi esclusivamente a <strong>enti di formazione accreditati</strong> secondo i criteri regionali.
                    </p>
                </div>
            </div>

            <!-- Crediti -->
            <div class="mb-8 p-6 bg-gray-50 rounded-xl border border-gray-200">
                <h3 class="font-bold text-gray-800 mb-3 flex items-center gap-2 text-lg">
                    <span class="text-2xl">üí≥</span> CREDITI
                </h3>
                <div class="text-sm text-gray-600 space-y-2">
                    <p>
                        <strong>Autore:</strong> Dott. Salvatore Trono ‚Äî Formatore qualificato ed Esperto in Sicurezza sul Lavoro
                    </p>
                    <p>
                        <strong>Riferimenti normativi:</strong> D.Lgs. 81/2008, Accordo Stato-Regioni 21/12/2011
                    </p>
                    <p>
                        <strong>Database domande:</strong> 128 quesiti elaborati da normativa vigente e best practice SSL
                    </p>
                    <p>
                        <strong>Tecnologie:</strong> HTML5, Tailwind CSS, JavaScript (Progressive Web App ready)
                    </p>
                    <p>
                        <strong>Licenza:</strong> ¬© 2025 Dott. Salvatore Trono ‚Äî Uso didattico-formativo <strong>Riproduzione vietata senza autorizzazione scritta dell'autore</strong>
                    </p>
                    <p class="text-xs text-gray-500 mt-3">
                        Per richieste di collaborazione, utilizzo o personalizzazioni, contattare l'autore tramite i canali ufficiali.
                    </p>
                </div>
            </div>

            <!-- Pulsante Avvio -->
            <div class="text-center">
                <button onclick="startQuiz()" class="btn-primary bg-gradient-to-r from-blue-600 to-purple-600 text-white px-12 py-4 rounded-xl font-bold text-xl shadow-lg hover:shadow-2xl">
                    üöÄ INIZIA IL QUIZ
                </button>
                <p class="text-gray-600 mt-4 font-semibold">Buon divertimento! üéØ</p>
            </div>
        </div>
    </div>

    <!-- Quiz Screen -->
    <div id="quizScreen" class="hidden container mx-auto px-4 py-8 max-w-7xl">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <!-- Main Content -->
            <div class="lg:col-span-3">
                <!-- Header -->
                <div class="bg-white rounded-2xl shadow-xl p-6 mb-6 fade-in">
                    <div class="flex flex-col sm:flex-row justify-between items-center gap-4">
                        <!-- Timer -->
                        <div class="flex items-center gap-3">
                            <span class="text-3xl">‚è±Ô∏è</span>
                            <div>
                                <div class="text-sm text-gray-600">Tempo rimasto</div>
                                <div id="timer" class="text-2xl font-bold text-gray-800">20:00</div>
                            </div>
                        </div>
                        
                        <!-- Progress -->
                        <div class="flex-1 max-w-md">
                            <div class="flex justify-between text-sm text-gray-600 mb-2">
                                <span>Domanda <span id="currentQ">1</span> di 15</span>
                                <span id="progressPercent">0%</span>
                            </div>
                            <div class="h-3 bg-gray-200 rounded-full overflow-hidden">
                                <div id="progressBar" class="progress-bar h-full bg-gradient-to-r from-blue-500 to-purple-600 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Question Card -->
                <div class="bg-white rounded-2xl shadow-xl p-8 slide-in">
                    <div class="mb-6">
                        <span class="bg-blue-100 text-blue-800 px-4 py-2 rounded-full text-sm font-semibold">
                            Domanda <span id="questionNumber">1</span>
                        </span>
                    </div>
                    
                    <h2 id="questionText" class="text-2xl font-bold text-gray-800 mb-8 leading-relaxed">
                        <!-- Domanda caricata dinamicamente -->
                    </h2>
                    
                    <div id="optionsContainer" class="space-y-4">
                        <!-- Opzioni caricate dinamicamente -->
                    </div>
                </div>
            </div>

            <!-- Minimap Sidebar -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-2xl shadow-xl p-6 sticky top-8">
                    <h3 class="font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span>üó∫Ô∏è</span> MAPPA DOMANDE
                    </h3>
                    <div id="minimap" class="grid grid-cols-5 gap-2">
                        <!-- Minimap generata dinamicamente -->
                    </div>
                    <div class="mt-6 text-xs text-gray-600 space-y-2">
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-4 bg-blue-500 rounded"></div>
                            <span>Risposta data</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-4 bg-gray-200 rounded"></div>
                            <span>Non risposta</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Summary Screen -->
    <div id="summaryScreen" class="hidden container mx-auto px-4 py-8 max-w-6xl">
        <div class="bg-white rounded-2xl shadow-2xl p-8 fade-in">
            <!-- Results Header -->
            <div class="text-center mb-8">
                <div id="resultIcon" class="text-8xl mb-4">üéØ</div>
                <h2 id="resultTitle" class="text-4xl font-bold text-gray-800 mb-2">
                    <!-- Titolo risultato -->
                </h2>
                <p id="resultSubtitle" class="text-xl text-gray-600">
                    <!-- Sottotitolo risultato -->
                </p>
            </div>

            <!-- Score Card -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-green-50 rounded-xl p-6 text-center border-2 border-green-200">
                    <div class="text-4xl mb-2">‚úÖ</div>
                    <div class="text-3xl font-bold text-green-700" id="correctCount">0</div>
                    <div class="text-sm text-gray-600">Risposte Corrette</div>
                </div>
                <div class="bg-red-50 rounded-xl p-6 text-center border-2 border-red-200">
                    <div class="text-4xl mb-2">‚ùå</div>
                    <div class="text-3xl font-bold text-red-700" id="incorrectCount">0</div>
                    <div class="text-sm text-gray-600">Risposte Errate</div>
                </div>
                <div class="bg-blue-50 rounded-xl p-6 text-center border-2 border-blue-200">
                    <div class="text-4xl mb-2">üìä</div>
                    <div class="text-3xl font-bold text-blue-700" id="scorePercent">0%</div>
                    <div class="text-sm text-gray-600">Punteggio Finale</div>
                </div>
            </div>

            <!-- Detailed Review -->
            <div class="mb-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span>üìù</span> RIEPILOGO DETTAGLIATO
                </h3>
                <div id="reviewContainer" class="space-y-4">
                    <!-- Review items generati dinamicamente -->
                </div>
            </div>

            <!-- Actions -->
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button onclick="location.reload()" class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-xl font-bold hover:shadow-xl transition-all">
                    üîÑ Rifai il Quiz
                </button>
                <a href="https://trono-slv.github.io/Valutazione-dei-rischi-in-magazzino/" 
                   target="_blank"
                   class="bg-gradient-to-r from-green-600 to-emerald-600 text-white px-8 py-4 rounded-xl font-bold hover:shadow-xl transition-all text-center">
                    üìö Torna alla Teoria
                </a>
            </div>
        </div>
    </div>

    <script>
        // ========================================
        // CONFIGURAZIONE
        // ========================================
        const TEST_QUESTIONS = 15;
        const TEST_DURATION = 1200; // 20 minuti in secondi
        const PASS_THRESHOLD = 0.70; // 70%

        // ========================================
        // DATABASE DOMANDE (128 quesiti)
        // ========================================
        const questionBank = [
            {
                question: "Qual √® la normativa principale che regola la sicurezza sul lavoro in Italia?",
                options: [
                    "D.Lgs. 626/1994",
                    "D.Lgs. 81/2008",
                    "Legge 300/1970",
                    "D.P.R. 547/1955"
                ],
                correct: 1,
                explanation: "Il D.Lgs. 81/2008 (Testo Unico sulla Sicurezza) √® la normativa attualmente in vigore che ha abrogato il D.Lgs. 626/1994."
            },
            {
                question: "Chi √® il Responsabile del Servizio di Prevenzione e Protezione (RSPP)?",
                options: [
                    "Una persona interna o esterna designata dal datore di lavoro",
                    "Sempre il datore di lavoro",
                    "Solo un consulente esterno certificato",
                    "Il rappresentante dei lavoratori"
                ],
                correct: 0,
                explanation: "L'RSPP pu√≤ essere interno o esterno all'azienda, ma deve essere designato dal datore di lavoro (art. 31-33 D.Lgs. 81/2008)."
            },
            {
                question: "Qual √® l'obbligo principale del datore di lavoro secondo il D.Lgs. 81/2008?",
                options: [
                    "Fornire solo i DPI",
                    "Valutare tutti i rischi e redigere il DVR",
                    "Assumere un RSPP esterno",
                    "Pagare l'INAIL"
                ],
                correct: 1,
                explanation: "L'art. 17 del D.Lgs. 81/2008 impone al datore di lavoro la valutazione di tutti i rischi e la redazione del Documento di Valutazione dei Rischi (DVR)."
            },
            {
                question: "Cosa significa l'acronimo DVR?",
                options: [
                    "Documento Valutazione Rischi",
                    "Dispositivo Vigilanza Rapida",
                    "Dichiarazione Verifica Reti",
                    "Dispositivo Valvola Riduzione"
                ],
                correct: 0,
                explanation: "DVR sta per Documento di Valutazione dei Rischi, obbligatorio per tutte le aziende con almeno un lavoratore (art. 28 D.Lgs. 81/2008)."
            },
            {
                question: "Entro quanto tempo va redatto il DVR dopo l'inizio dell'attivit√†?",
                options: [
                    "30 giorni",
                    "90 giorni",
                    "6 mesi",
                    "Immediatamente"
                ],
                correct: 1,
                explanation: "Il DVR deve essere elaborato entro 90 giorni dall'inizio dell'attivit√† (art. 28, comma 3-bis D.Lgs. 81/2008)."
            },
            {
                question: "Chi √® il RLS (Rappresentante dei Lavoratori per la Sicurezza)?",
                options: [
                    "Una figura nominata dal datore di lavoro",
                    "Un consulente esterno",
                    "Una persona eletta o designata dai lavoratori",
                    "Il medico competente"
                ],
                correct: 2,
                explanation: "Il RLS √® eletto o designato dai lavoratori per rappresentarli nelle questioni di salute e sicurezza (art. 47 D.Lgs. 81/2008)."
            },
            {
                question: "Cosa sono i DPI?",
                options: [
                    "Dispositivi di Protezione Individuale",
                    "Documenti Prevenzione Infortuni",
                    "Dispositivi Protezione Incendi",
                    "Dispositivi Processi Industriali"
                ],
                correct: 0,
                explanation: "I DPI (Dispositivi di Protezione Individuale) sono attrezzature destinate a proteggere il lavoratore dai rischi (art. 74 D.Lgs. 81/2008)."
            },
            {
                question: "Qual √® la gerarchia delle misure di prevenzione secondo il D.Lgs. 81/2008?",
                options: [
                    "Prima i DPI, poi le misure tecniche",
                    "Prima eliminare/ridurre i rischi, poi protezione collettiva, infine DPI",
                    "Solo misure organizzative",
                    "Solo formazione e informazione"
                ],
                correct: 1,
                explanation: "L'art. 15 stabilisce la gerarchia: 1) Eliminazione/riduzione rischi, 2) Protezione collettiva, 3) DPI come ultima ratio."
            },
            {
                question: "Qual √® la periodicit√† minima della sorveglianza sanitaria per i lavoratori esposti a rischi specifici?",
                options: [
                    "Mensile",
                    "Annuale",
                    "Biennale",
                    "A discrezione del medico competente"
                ],
                correct: 3,
                explanation: "La periodicit√† √® stabilita dal medico competente in base al tipo di rischio, ma generalmente almeno annuale (art. 41 D.Lgs. 81/2008)."
            },
            {
                question: "Cosa prevede l'art. 20 del D.Lgs. 81/2008?",
                options: [
                    "Gli obblighi del datore di lavoro",
                    "Gli obblighi dei lavoratori",
                    "Le sanzioni per le violazioni",
                    "La nomina dell'RSPP"
                ],
                correct: 1,
                explanation: "L'art. 20 elenca gli obblighi dei lavoratori: prendersi cura della propria sicurezza, utilizzare correttamente i DPI, segnalare pericoli, ecc."
            },
            {
                question: "Qual √® la differenza tra pericolo e rischio?",
                options: [
                    "Sono sinonimi",
                    "Pericolo = propriet√† intrinseca; Rischio = probabilit√† di danno",
                    "Rischio √® pi√π grave del pericolo",
                    "Pericolo riguarda solo le macchine"
                ],
                correct: 1,
                explanation: "Pericolo √® la propriet√†/qualit√† intrinseca di causare danno; Rischio √® la probabilit√† che si verifichi un danno (art. 2 D.Lgs. 81/2008)."
            },
            {
                question: "In un magazzino, quale rischio √® prioritario nella valutazione?",
                options: [
                    "Solo il rischio elettrico",
                    "Movimentazione manuale dei carichi, caduta materiali, investimento mezzi",
                    "Solo il rischio biologico",
                    "Solo il rischio rumore"
                ],
                correct: 1,
                explanation: "In magazzino i rischi principali sono: movimentazione carichi, caduta oggetti dall'alto, investimento da carrelli/muletti, scivolamenti."
            },
            {
                question: "Qual √® il peso massimo consigliato per la movimentazione manuale occasionale (uomini)?",
                options: [
                    "15 kg",
                    "20 kg",
                    "25 kg",
                    "30 kg"
                ],
                correct: 2,
                explanation: "Secondo la norma ISO 11228-1, il peso massimo consigliato per sollevamento occasionale √® 25 kg per uomini adulti in condizioni ideali."
            },
            {
                question: "Cosa si intende per 'near miss'?",
                options: [
                    "Un infortunio grave",
                    "Un mancato infortunio",
                    "Una malattia professionale",
                    "Un rischio chimico"
                ],
                correct: 1,
                explanation: "Near miss (quasi infortunio) √® un evento che avrebbe potuto causare un infortunio ma non lo ha causato per fortuna o intervento tempestivo."
            },
            {
                question: "Qual √® la segnaletica di sicurezza obbligatoria in un magazzino?",
                options: [
                    "Solo uscite di emergenza",
                    "Uscite emergenza, estintori, primo soccorso, percorsi pedonali, carichi sospesi",
                    "Solo divieto di fumare",
                    "Solo estintori"
                ],
                correct: 1,
                explanation: "Secondo il Titolo V del D.Lgs. 81/2008, sono obbligatorie le segnalazioni di emergenza, antincendio, primo soccorso e pericoli specifici."
            },
            {
                question: "Quale DPI √® obbligatorio in un magazzino con movimentazione carichi?",
                options: [
                    "Solo guanti",
                    "Scarpe antinfortunistiche, guanti, casco se rischio caduta oggetti, gilet alta visibilit√†",
                    "Solo occhiali",
                    "Nessun DPI"
                ],
                correct: 1,
                explanation: "La valutazione dei rischi determina i DPI necessari: tipicamente scarpe S3, guanti, casco (se rischio caduta dall'alto), gilet se circolano mezzi."
            },
            {
                question: "Qual √® la larghezza minima delle vie di circolazione nei luoghi di lavoro?",
                options: [
                    "50 cm",
                    "70 cm",
                    "80 cm",
                    "100 cm"
                ],
                correct: 2,
                explanation: "Secondo l'Allegato IV del D.Lgs. 81/2008, le vie di circolazione devono essere larghe almeno 80 cm (ideale 120 cm)."
            },
            {
                question: "Cosa prevede il Piano di Emergenza aziendale?",
                options: [
                    "Solo procedure antincendio",
                    "Procedure evacuazione, primo soccorso, gestione emergenze, ruoli squadre",
                    "Solo numeri di emergenza",
                    "Solo planimetrie"
                ],
                correct: 1,
                explanation: "Il Piano di Emergenza (art. 43 D.Lgs. 81/2008) include: procedure evacuazione, gestione emergenze, squadre antincendio/primo soccorso, comunicazioni."
            },
            {
                question: "Qual √® la distanza massima da un estintore in un magazzino?",
                options: [
                    "10 metri",
                    "20 metri",
                    "30 metri",
                    "50 metri"
                ],
                correct: 2,
                explanation: "La norma UNI 9994-1 prevede che ogni punto del locale disti al massimo 30 metri da un estintore (per rischio incendio medio)."
            },
            {
                question: "Qual √® la capacit√† minima di un estintore portatile?",
                options: [
                    "1 kg",
                    "3 kg",
                    "6 kg",
                    "9 kg"
                ],
                correct: 2,
                explanation: "Gli estintori portatili devono avere capacit√† minima di 6 kg/litri (classe A-B) secondo il D.M. 10/03/1998."
            },
            {
                question: "Cosa si intende per 'carico unitario'?",
                options: [
                    "Il peso totale del magazzino",
                    "Il carico che pu√≤ sollevare una persona",
                    "Un singolo pacco o unit√† di stoccaggio",
                    "Il carico massimo di un carrello"
                ],
                correct: 2,
                explanation: "Carico unitario √® l'unit√† di carico movimentata (pallet, collo, scatola) come singola entit√† durante le operazioni logistiche."
            },
            {
                question: "Qual √® la normativa specifica per le scaffalature industriali?",
                options: [
                    "UNI EN 15512",
                                        "ISO 9001",
                    "D.Lgs. 81/2008",
                    "Nessuna normativa specifica"
                ],
                correct: 0,
                explanation: "La norma UNI EN 15512 regola la progettazione, installazione e utilizzo delle scaffalature portapallet statiche in acciaio."
            },
            {
                question: "Ogni quanto vanno ispezionate le scaffalature metalliche?",
                options: [
                    "Mensilmente",
                    "Ogni 6 mesi",
                    "Annualmente",
                    "Ogni 2 anni"
                ],
                correct: 2,
                explanation: "La UNI EN 15635 raccomanda ispezioni settimanali degli addetti e annuali da parte di esperti qualificati (PRSES)."
            },
            {
                question: "Cosa indica la portata massima di una scaffalatura?",
                options: [
                    "Il peso totale della scaffalatura",
                    "Il peso massimo per singola campata o livello",
                    "Solo il peso del telaio",
                    "Il peso degli operatori"
                ],
                correct: 1,
                explanation: "La portata indica il carico massimo ammissibile per campata (o livello), comprensivo del peso dei contenitori e materiali stoccati."
            },
            {
                question: "Quale colore identifica le tubazioni antincendio?",
                options: [
                    "Giallo",
                    "Verde",
                    "Rosso",
                    "Blu"
                ],
                correct: 2,
                explanation: "Secondo la norma UNI 5634, il rosso RAL 3000 identifica le tubazioni antincendio e i relativi impianti."
            },
            {
                question: "Qual √® la funzione del 'just in time' nella sicurezza di magazzino?",
                options: [
                    "Riduce gli spazi di stoccaggio e i rischi di accumulo",
                    "Aumenta i rischi",
                    "Non ha impatti sulla sicurezza",
                    "Solo ottimizzazione economica"
                ],
                correct: 0,
                explanation: "Il just in time riduce le scorte, liberando spazi e riducendo rischi di accumulo materiali, caduta oggetti e congestione vie di fuga."
            },
            {
                question: "Cosa prevede il metodo FIFO?",
                options: [
                    "First In First Out (primo entrato, primo uscito)",
                    "First In First On (primo entrato, primo acceso)",
                    "Fast Input Fast Output",
                    "Final Inventory First Output"
                ],
                correct: 0,
                explanation: "FIFO (First In First Out) garantisce che i prodotti pi√π vecchi siano spediti per primi, riducendo obsolescenza e rischi di deterioramento."
            },
            {
                question: "Qual √® l'altezza massima consigliata per il prelievo manuale senza ausili?",
                options: [
                    "1,5 metri",
                    "2 metri",
                    "2,5 metri",
                    "3 metri"
                ],
                correct: 1,
                explanation: "Secondo l'ergonomia, il prelievo manuale ottimale √® tra 0,6-1,7 m; oltre i 2 m sono necessari ausili (scale, piattaforme)."
            },
            {
                question: "Cosa si intende per 'zona di picking'?",
                options: [
                    "Area di carico/scarico camion",
                    "Area dedicata al prelievo ordini",
                    "Zona uffici",
                    "Area pausa"
                ],
                correct: 1,
                explanation: "La zona di picking √® l'area del magazzino dedicata al prelievo delle merci per comporre gli ordini da spedire."
            },
            {
                question: "Qual √® il rischio principale durante l'uso di transpallet manuale?",
                options: [
                    "Rischio elettrico",
                    "Schiacciamento piedi, sovraccarico biomeccanico, investimento",
                    "Rischio biologico",
                    "Solo rischio rumore"
                ],
                correct: 1,
                explanation: "I transpallet manuali comportano rischi di schiacciamento piedi, sovraccarico rachide lombare (spinta carichi pesanti), investimento pedoni."
            },
            {
                question: "Quale patentino √® obbligatorio per condurre carrelli elevatori?",
                options: [
                    "Patente B",
                    "Abilitazione ex Accordo Stato-Regioni 22/02/2012",
                    "Nessun patentino",
                    "Solo patente A"
                ],
                correct: 1,
                explanation: "L'Accordo Stato-Regioni del 22/02/2012 (art. 73 D.Lgs. 81/2008) richiede abilitazione specifica con corso teorico-pratico e verifica."
            },
            {
                question: "Ogni quanto va rinnovata l'abilitazione per carrellisti?",
                options: [
                    "Ogni anno",
                    "Ogni 3 anni",
                    "Ogni 5 anni",
                    "Mai"
                ],
                correct: 2,
                explanation: "L'abilitazione per carrelli elevatori va rinnovata ogni 5 anni con corso di aggiornamento di 4 ore (Accordo SR 22/02/2012)."
            },
            {
                question: "Qual √® la velocit√† massima consentita per i carrelli in magazzino?",
                options: [
                    "5 km/h",
                    "10 km/h",
                    "20 km/h",
                    "Non specificata, ma prudente"
                ],
                correct: 3,
                explanation: "Non esiste limite normativo specifico, ma va adottata velocit√† prudente in funzione di visibilit√†, traffico, condizioni pavimento (generalmente max 10 km/h)."
            },
            {
                question: "Cosa indica il cartello con triangolo giallo e punto esclamativo?",
                options: [
                    "Pericolo generico",
                    "Divieto generico",
                    "Obbligo generico",
                    "Informazione"
                ],
                correct: 0,
                explanation: "Il triangolo giallo con punto esclamativo indica un pericolo generico o attenzione (D.Lgs. 81/2008, Titolo V)."
            },
            {
                question: "Qual √® la funzione delle protezioni laterali delle scaffalature?",
                options: [
                    "Estetica",
                    "Impedire caduta materiali sui lati e passaggi",
                    "Solo identificazione",
                    "Nessuna funzione"
                ],
                correct: 1,
                explanation: "Le protezioni laterali (reti, pannelli) impediscono la caduta di materiali sui corridoi di transito e verso spazi adiacenti."
            },
            {
                question: "Cosa prevede il 'lock out - tag out'?",
                options: [
                    "Chiusura magazzino di notte",
                    "Procedura di messa in sicurezza macchinari (blocco energia + cartellino)",
                    "Etichettatura prodotti",
                    "Controllo accessi"
                ],
                correct: 1,
                explanation: "Lock Out Tag Out √® la procedura di sicurezza per isolare energie pericolose durante manutenzione (blocco fisico + cartellino identificativo)."
            },
            {
                question: "Qual √® l'illuminamento minimo richiesto nei magazzini?",
                options: [
                    "50 lux",
                    "100 lux",
                    "200 lux",
                    "500 lux"
                ],
                correct: 1,
                explanation: "La norma UNI EN 12464-1 prevede almeno 100 lux per aree generali di magazzino, 200 lux per zone picking/imballaggio."
            },
            {
                question: "Cosa si intende per 'ergonomia posturale'?",
                options: [
                    "Solo esercizi fisici",
                    "Adattamento del lavoro alle caratteristiche psicofisiche dell'operatore",
                    "Solo pause",
                    "Solo formazione"
                ],
                correct: 1,
                explanation: "Ergonomia posturale significa progettare postazioni/compiti adattandoli alle capacit√† umane, riducendo posture incongrue e sovraccarico biomeccanico."
            },
            {
                question: "Qual √® la temperatura ideale in un magazzino per lavoratori?",
                options: [
                    "10-15¬∞C",
                    "18-24¬∞C",
                    "25-30¬∞C",
                    "Qualsiasi temperatura"
                ],
                correct: 1,
                explanation: "Per lavoro sedentario/leggero la temperatura ideale √® 19-24¬∞C; per attivit√† fisica moderata 16-21¬∞C (norma UNI EN ISO 7730)."
            },
            {
                question: "Cosa prevede la normativa ATEX?",
                options: [
                    "Trasporto merci pericolose",
                    "Atmosfere esplosive (polveri, gas)",
                    "Solo sostanze chimiche",
                    "Solo materiali radioattivi"
                ],
                correct: 1,
                explanation: "Le direttive ATEX (94/9/CE e 99/92/CE, recepite con D.Lgs. 81/2008 Titolo XI) regolano la sicurezza in ambienti con atmosfere esplosive."
            },
            {
                question: "Qual √® la classe di reazione al fuoco richiesta per materiali in vie di fuga?",
                options: [
                    "Classe 0 (incombustibile)",
                    "Classe 1",
                    "Classe 2",
                    "Qualsiasi classe"
                ],
                correct: 0,
                explanation: "D.M. 26/06/1984: materiali di rivestimento in vie di esodo devono essere classe 0 (incombustibili) o classe 1 (non infiammabili)."
            },
            {
                question: "Cosa indica il pittogramma GHS07 (punto esclamativo)?",
                options: [
                    "Esplosivo",
                    "Tossicit√† acuta (cat 4), irritazione, sensibilizzazione cutanea",
                    "Corrosivo",
                    "Infiammabile"
                ],
                correct: 1,
                explanation: "GHS07 indica: tossicit√† acuta categoria 4, irritante per pelle/occhi/vie respiratorie, sensibilizzante cutaneo, tossicit√† specifica monoesposizione."
            },
            {
                question: "Qual √® la distanza minima tra scaffalature opposte (corridoio)?",
                options: [
                    "50 cm",
                    "1 metro",
                    "Larghezza mezzo + 70 cm per lato",
                    "Non specificata"
                ],
                correct: 2,
                explanation: "I corridoi devono permettere il transito sicuro dei mezzi: generalmente larghezza carrello + 70 cm per lato (es. carrello 1,2m ‚Üí corridoio min 2,6m)."
            },
            {
                question: "Cosa prevede il Registro Infortuni?",
                options: [
                    "Solo infortuni mortali",
                    "Tutti gli infortuni con prognosi >3 giorni",
                    "Solo malattie professionali",
                    "Non √® pi√π obbligatorio"
                ],
                correct: 3,
                explanation: "Dal 2016 il Registro Infortuni cartaceo √® abolito; gli infortuni vanno comunicati telematicamente all'INAIL (obbligo denuncia se prognosi >3 gg)."
            },
            {
                question: "Qual √® la sanzione per omessa valutazione dei rischi (DVR)?",
                options: [
                    "Solo richiamo",
                    "Arresto da 3 a 6 mesi o ammenda ‚Ç¨2.500-6.400",
                    "Solo ammenda ‚Ç¨500",
                    "Nessuna sanzione"
                ],
                correct: 1,
                explanation: "L'art. 55 del D.Lgs. 81/2008 prevede per omessa valutazione rischi: arresto da 3 a 6 mesi o ammenda da ‚Ç¨2.500 a ‚Ç¨6.400."
            },
            {
                question: "Chi pu√≤ effettuare la formazione sulla sicurezza?",
                options: [
                    "Chiunque",
                    "Solo l'RSPP",
                    "Soggetti formatori accreditati secondo criteri Accordo SR 07/07/2016",
                    "Solo ispettori ASL"
                ],
                correct: 2,
                explanation: "L'Accordo Stato-Regioni del 07/07/2016 definisce i requisiti dei formatori: esperienza, titoli di studio e competenze specifiche certificate."
            },
            {
                question: "Qual √® la durata minima della formazione generale per lavoratori?",
                options: [
                    "2 ore",
                    "4 ore",
                    "8 ore",
                    "16 ore"
                ],
                correct: 1,
                explanation: "L'Accordo SR 21/12/2011 prevede 4 ore di formazione generale uguale per tutti i settori, pi√π formazione specifica (4/8/12 h) in base al rischio."
            },
            {
                question: "Ogni quanto va aggiornata la formazione dei lavoratori?",
                options: [
                    "Ogni anno",
                    "Ogni 3 anni",
                    "Ogni 5 anni (6 ore)",
                    "Mai"
                ],
                correct: 2,
                explanation: "L'aggiornamento √® quinquennale con durata minima di 6 ore per tutti i settori (Accordo SR 21/12/2011, punto 9.3)."
            },
            {
                question: "Cosa si intende per 'near miss reporting'?",
                options: [
                    "Denuncia infortuni",
                    "Segnalazione proattiva di mancati infortuni per analisi preventiva",
                    "Registro presenze",
                    "Comunicazione ferie"
                ],
                correct: 1,
                explanation: "Near miss reporting √® il sistema di segnalazione volontaria di quasi-infortuni per analizzare cause e prevenire futuri incidenti (cultura della sicurezza)."
            },
            {
                question: "Qual √® la funzione del 'safety walkthrough'?",
                options: [
                    "Passeggiata aziendale",
                    "Ispezione periodica degli ambienti per identificare pericoli",
                    "Formazione mobile",
                    "Evacuazione"
                ],
                correct: 1,
                explanation: "Safety walkthrough (sopralluogo di sicurezza) √® un'ispezione programmata degli ambienti di lavoro per identificare condizioni/comportamenti a rischio."
            },
            {
                question: "Cosa prevede la metodologia '5S' per la sicurezza?",
                options: [
                    "Solo pulizia",
                    "Seiri (separare), Seiton (ordinare), Seiso (pulire), Seiketsu (standardizzare), Shitsuke (sostenere)",
                    "Solo controlli",
                    "Nessuna relazione con sicurezza"
                ],
                correct: 1,
                explanation: "Le 5S giapponesi migliorano organizzazione e ordine del posto di lavoro, riducendo infortuni da inciampo, cadute, ricerca affannosa oggetti."
            },
            {
                question: "Qual √® il significato del cartello rotondo blu con pittogramma bianco?",
                options: [
                    "Divieto",
                    "Obbligo (es. indossare DPI)",
                    "Pericolo",
                    "Informazione"
                ],
                correct: 1,
                explanation: "I cartelli circolari blu indicano prescrizioni/obblighi (es. obbligo casco, guanti, protezioni) secondo D.Lgs. 81/2008 Allegato XXV."
            },
            {
                question: "Cosa indica il rombo arancione con numero ONU sulle merci pericolose?",
                options: [
                    "Codice prodotto",
                    "Classificazione ADR (trasporto merci pericolose)",
                    "Prezzo",
                    "Data scadenza"
                ],
                correct: 1,
                explanation: "Il rombo arancione ADR/RID indica classe di pericolo (numero in alto) e numero ONU identificativo sostanza (numero in basso) per trasporti."
            },
            {
                question: "Qual √® la procedura corretta per sollevamento manuale carichi?",
                options: [
                    "Piegare la schiena",
                    "Gambe piegate, schiena dritta, carico vicino al corpo",
                    "Torcere il busto",
                    "Sollevare di scatto"
                ],
                correct: 1,
                explanation: "Tecnica corretta: gambe flesse, schiena dritta, carico vicino al corpo, presa salda, sollevamento con gambe (non schiena), no torsioni (ISO 11228)."
            },
            {
                question: "Cosa si intende per 'reach truck'?",
                options: [
                    "Camion per trasporti",
                    "Carrello elevatore retrattile per corsie strette",
                    "Sistema informatico",
                    "Scaffalatura"
                ],
                correct: 1,
                explanation: "Reach truck √® un carrello elevatore con forche retrattili che permettono di operare in corsie pi√π strette (2,5-2,8 m) rispetto ai frontali."
            },
            {
                question: "Qual √® la funzione della 'gabbia di sicurezza' sul carrello?",
                options: [
                    "Trasporto gabbie",
                    "Protezione operatore durante sollevamento (piattaforma lavoro aereo)",
                    "Decorazione",
                    "Stoccaggio"
                ],
                correct: 1,
                explanation: "La gabbia/piattaforma con protezioni perimetrali protegge l'operatore sollevato dal carrello per lavori in quota (es. prelievi alti, manutenzioni)."
            },
            {
                question: "Cosa prevede il sistema 'man-down'?",
                options: [
                    "Riduzione personale",
                    "Allarme automatico se lavoratore isolato cade/√® immobile",
                    "Procedura scarico",
                    "Turni notturni"
                ],
                correct: 1,
                explanation: "I dispositivi man-down rilevano automaticamente cadute/immobilit√† del lavoratore isolato e attivano allarme per soccorso tempestivo."
            },
            {
                question: "Qual √® la normativa per gli impianti elettrici nei luoghi di lavoro?",
                options: [
                    "Solo D.Lgs. 81/2008",
                    "D.Lgs. 81/2008 + norme CEI (es. 64-8)",
                    "Nessuna normativa",
                    "Solo leggi regionali"
                ],
                correct: 1,
                explanation: "Il Titolo III del D.Lgs. 81/2008 rinvia alle norme CEI (es. 64-8 per impianti BT) per la conformit√† e sicurezza degli impianti elettrici."
            },
            {
                question: "Ogni quanto va verificato l'impianto di messa a terra?",
                options: [
                    "Ogni 6 mesi",
                    "Ogni 2 anni (luoghi ordinari) o 5 anni (ambienti speciali)",
                    "Mai",
                    "Solo all'installazione"
                ],
                correct: 1,
                explanation: "D.P.R. 462/2001: verifica biennale per luoghi ordinari; ogni 5 anni per luoghi a maggior rischio incendio (salvo deroghe ASL/ARPA)."
            },
            {
                question: "Cosa indica la sigla 'IP' seguita da due numeri (es. IP65)?",
                options: [
                    "Potenza elettrica",
                    "Grado protezione involucro (polveri/liquidi)",
                    "Indice prestazione",
                    "Niente"
                ],
                correct: 1,
                explanation: "IP (Ingress Protection) indica il grado di protezione contro corpi solidi (1¬™ cifra) e liquidi (2¬™ cifra) secondo norma CEI EN 60529."
            },
            {
                question: "Qual √® la differenza tra sovraccarico e cortocircuito?",
                options: [
                    "Sono uguali",
                    "Sovraccarico = corrente eccessiva prolungata; Cortocircuito = contatto diretto fasi",
                    "Solo problemi meccanici",
                    "Non esistono"
                ],
                correct: 1,
                explanation: "Sovraccarico: corrente superiore alla nominale ma in circuito integro (causa surriscaldamento). Cortocircuito: contatto fasi/fase-neutro (corrente elevatissima)."
            },
            {
                question: "Cosa prevede il D.M. 03/08/2015?",
                options: [
                    "Solo antincendio",
                    "Nuove norme tecniche prevenzione incendi (Codice Prevenzione Incendi)",
                    "Solo primo soccorso",
                    "Trasporti"
                ],
                correct: 1,
                explanation: "Il D.M. 03/08/2015 (aggiornato) √® il Codice di Prevenzione Incendi che introduce approccio prestazionale alla sicurezza antincendio."
            },
            {
                question: "Qual √® la classificazione dei luoghi di lavoro ai fini antincendio (vecchia classificazione)?",
                options: [
                    "Solo basso rischio",
                    "Basso, medio, elevato rischio",
                    "Solo alto rischio",
                    "Nessuna classificazione"
                ],
                correct: 1,
                explanation: "Il D.M. 10/03/1998 classifica i luoghi in basso/medio/elevato rischio incendio (oggi sostituito progressivamente dal Codice Prevenzione Incendi)."
            },
            {
                question: "Quanti addetti antincendio servono in un magazzino?",
                options: [
                    "Sempre uno",
                    "Numero adeguato in base a valutazione rischi, dimensioni, turnazioni",
                    "Nessuno",
                    "Solo uno ogni 100 persone"
                ],
                correct: 1,
                explanation: "Il numero di addetti antincendio va determinato in base a DVR, dimensioni, affollamento, turnazioni, per garantire copertura continua (art. 43 D.Lgs. 81/08)."
            },
            {
                question: "Qual √® la durata del corso antincendio rischio medio?",
                options: [
                    "4 ore",
                    "8 ore",
                    "16 ore",
                    "2 ore"
                ],
                correct: 1,
                explanation: "D.M. 10/03/1998: rischio basso 4h, medio 8h, elevato 16h. Dal D.M. 02/09/2021: livello 1=4h, livello 2=8h, livello 3=16h (con verifica)."
            },
            {
                question: "Cosa contiene la cassetta di primo soccorso?",
                options: [
                    "Solo cerotti",
                    "Materiale sanitario definito dal D.M. 388/2003 (guanti, garze, disinfettanti, etc.)",
                    "Farmaci",
                    "Solo telefono emergenze"
                ],
                correct: 1,
                explanation: "D.M. 388/2003 Allegato 1: cassetta deve contenere guanti monouso, disinfettanti, garze, bende, lacci emostatici, forbici, ghiaccio, termometro, etc."
            },
            {
                question: "Ogni quanto va controllata la cassetta di primo soccorso?",
                options: [
                    "Settimanalmente",
                    "Mensilmente",
                    "Ogni 6 mesi",
                    "Solo alla scadenza"
                ],
                correct: 1,
                explanation: "Buona prassi: controllo mensile per verificare integrit√†, completezza, scadenze. Controllo immediato dopo ogni utilizzo per reintegro."
            },
            {
                question: "Qual √® la sequenza corretta del BLS (rianimazione cardiopolmonare)?",
                options: [
                    "Solo massaggio",
                    "Verifica coscienza ‚Üí chiamata 118 ‚Üí 30 compressioni + 2 ventilazioni",
                    "Solo ventilazioni",
                    "Aspettare ambulanza"
                ],
                correct: 1,
                explanation: "BLS moderno (ILCOR 2021): Valutazione sicurezza ‚Üí coscienza ‚Üí 118 ‚Üí 30 compressioni toraciche (5-6 cm, 100-120/min) + 2 insufflazioni ‚Üí ripetere."
            },
            {
                question: "Dove va posizionato il DAE (defibrillatore)?",
                options: [
                    "Solo in ospedale",
                    "Luoghi accessibili, segnalati, max 1-2 min dal punto pi√π lontano",
                    "Solo in uffici",
                    "Non serve"
                ],
                correct: 1,
                explanation: "Il DAE va posto in posizione visibile, accessibile H24, segnalato, raggiungibile in max 1-2 minuti da qualsiasi punto (D.M. 18/03/2011)."
            },
            {
                question: "Cosa prevede la Direttiva Macchine 2006/42/CE?",
                options: [
                    "Solo trasporti",
                    "Requisiti di sicurezza per immissione in commercio macchine (marcatura CE)",
                    "Solo elettrodomestici",
                    "Niente"
                ],
                correct: 1,
                explanation: "La Direttiva Macchine (recepita con D.Lgs. 17/2010) stabilisce requisiti essenziali di sicurezza per la progettazione/commercializzazione di macchine."
            },
            {
                question: "Cos'√® la marcatura CE sulle macchine?",
                options: [
                    "Certificato di qualit√†",
                    "Dichiarazione conformit√† del fabbricante ai requisiti UE di sicurezza",
                    "Made in Europe",
                    "Controllo Europeo"
                ],
                correct: 1,
                explanation: "La marcatura CE √® autodichiarazione del fabbricante di conformit√† della macchina ai requisiti essenziali di sicurezza delle direttive europee applicabili."
            },
            {
                question: "Cosa contiene il Fascicolo Tecnico di una macchina?",
                options: [
                    "Solo prezzo",
                    "Disegni, calcoli, analisi rischi, dichiarazioni conformit√† componenti, manuale",
                    "Solo garanzia",
                    "Niente"
                ],
                correct: 1,
                explanation: "Il fascicolo tecnico (all. VII Dir. Macchine) comprende: disegni tecnici, valutazione rischi, norme applicate, manuali, certificati componenti di sicurezza."
            },
            {
                question: "Qual √® la funzione dei ripari sulle macchine?",
                options: [
                    "Estetica",
                    "Impedire accesso a zone pericolose durante funzionamento",
                    "Solo protezione polvere",
                    "Niente"
                ],
                correct: 1,
                explanation: "I ripari (fissi, mobili interbloccati, regolabili) impediscono l'accesso a organi di trasmissione e zone pericolose per contatto/intrappolamento."
            },
            {
                question: "Cosa si intende per 'dispositivo di interblocco'?",
                options: [
                    "Chiusura a chiave",
                    "Dispositivo che impedisce avvio macchina se riparo aperto o ferma macchina se aperto",
                    "Solo allarme sonoro",
                    "Blocco ruote"
                ],
                correct: 1,
                explanation: "L'interblocco collega il riparo mobile al comando: macchina non parte se riparo aperto; se aperto durante funzionamento, la macchina si ferma."
            },
            {
                question: "Cosa prevede il DUVRI?",
                options: [
                    "Valutazione rischi interni",
                    "Documento Unico Valutazione Rischi Interferenti (committente + appaltatori)",
                    "Solo contratti",
                    "Niente"
                ],
                correct: 1,
                explanation: "Il DUVRI (art. 26 D.Lgs. 81/2008) valuta i rischi da interferenze tra attivit√† del committente e dell'appaltatore/subappaltatore nei contratti d'opera."
            },
            {
                question: "Chi redige il DUVRI?",
                options: [
                    "L'appaltatore",
                    "Il committente (datore di lavoro che affida lavori)",
                    "Il lavoratore",
                    "Nessuno"
                ],
                correct: 1,
                explanation: "Il committente (datore di lavoro committente) redige il DUVRI, indicando costi sicurezza non soggetti a ribasso (art. 26 comma 3 e 3-bis)."
            },
            {
                question: "Qual √® l'obbligo del committente verso gli appaltatori?",
                options: [
                    "Solo pagamento",
                    "Verifica idoneit√† tecnico-professionale, fornitura info rischi, cooperazione",
                    "Niente",
                    "Solo contratto"
                ],
                correct: 1,
                explanation: "Art. 26 D.Lgs. 81/08: committente deve verificare idoneit√† imprese (CCIAA, DURC, DVR), informare su rischi, coordinare misure, redigere DUVRI."
            },
            {
                question: "Cosa si intende per 'atmosfera esplosiva'?",
                options: [
                    "Solo gas",
                    "Miscela aria + sostanze infiammabili (gas/vapori/polveri) in proporzioni esplosive",
                    "Solo polveri",
                    "Solo temperature alte"
                ],
                correct: 1,
                explanation: "Atmosfera esplosiva: miscela di aria con gas/vapori/nebbie o polveri infiammabili in concentrazione tale da poter esplodere (campo infiammabilit√†)."
            },
            {
                question: "Cosa indica il marchio ATEX su un apparecchio?",
                options: [
                    "Alta tecnologia",
                    "Certificazione per utilizzo in atmosfere potenzialmente esplosive",
                    "Solo qualit√†",
                    "Niente"
                ],
                correct: 1,
                explanation: "Il marchio ATEX (Ex in esagono) certifica che l'apparecchio √® progettato per operare in sicurezza in ambienti con possibili atmosfere esplosive."
            },
            {
                question: "Quali sono le zone ATEX per gas?",
                options: [
                    "Solo zona 0",
                    "Zona 0 (continua), Zona 1 (probabile), Zona 2 (improbabile)",
                    "Solo zona 1",
                    "Nessuna classificazione"
                ],
                correct: 1,
                explanation: "Classificazione gas: Zona 0 (atmosfera esplosiva continua/lunga durata), Zona 1 (probabile funzionamento normale), Zona 2 (improbabile/breve)."
            },
            {
                question: "Cosa prevede il Piano Operativo di Sicurezza (POS)?",
                options: [
                    "Solo edilizia",
                    "Documento dell'impresa esecutrice con analisi rischi e misure adottate (cantieri)",
                    "Solo contratti",
                    "Niente"
                ],
                correct: 1,
                explanation: "Il POS (Titolo IV D.Lgs. 81/2008) √® redatto dall'impresa esecutrice nei cantieri temporanei/mobili, dettagliando rischi e misure specifiche."
            },
            {
                question: "Chi √® il Coordinatore per la Sicurezza in fase di Progettazione (CSP)?",
                options: [
                    "Il muratore",
                    "Tecnico abilitato nominato dal committente per redigere PSC in cantieri complessi",
                    "Il direttore lavori",
                    "Nessuno"
                ],
                correct: 1,
                explanation: "Il CSP (art. 89-91 D.Lgs. 81/2008) √® nominato dal committente per redigere il Piano di Sicurezza e Coordinamento (PSC) in fase progettuale."
            },
            {
                question: "Cosa prevede il PSC (Piano di Sicurezza e Coordinamento)?",
                options: [
                    "Solo tempi lavori",
                    "Analisi rischi, coordinamento imprese, misure prevenzione, prescrizioni operative (cantieri)",
                    "Solo costi",
                    "Niente"
                ],
                correct: 1,
                explanation: "Il PSC (art. 100 D.Lgs. 81/2008) definisce rischi del cantiere, interferenze tra imprese, misure preventive, procedure emergenza, coordinamento."
            },
            {
                question: "Quando √® obbligatorio il Piano di Montaggio, Uso e Smontaggio (PIMUS) dei ponteggi?",
                options: [
                    "Mai",
                    "Sempre per ponteggi >2 metri",
                    "Solo ponteggi metallici",
                    "Solo se richiesto"
                ],
                correct: 1,
                explanation: "L'art. 136 D.Lgs. 81/2008 obbliga il PIMUS per ogni ponteggio, con procedure di montaggio/smontaggio, verifiche, schema, DPI necessari."
            },
            {
                question: "Qual √® l'altezza minima di una protezione laterale (parapetto)?",
                options: [
                    "50 cm",
                    "1 metro (corrente superiore a 1-1,2m + intermedio + tavola fermapiede 20cm)",
                    "2 metri",
                    "Non specificata"
                ],
                correct: 1,
                explanation: "All. IV D.Lgs. 81/2008: parapetti devono avere corrente superiore 1-1,2m, intermedio a met√†, tavola fermapiede almeno 15 cm (meglio 20 cm)."
            },
            {
                question: "Cosa si intende per 'Piano di Emergenza Interno (PEI)'?",
                options: [
                    "Solo evacuazione",
                    "Documento con procedure emergenze (incendio, evacuazione, primo soccorso, seveso se applicabile)",
                    "Solo numeri telefono",
                    "Niente"
                ],
                correct: 1,
                explanation: "Il PEI descrive: scenari emergenza, procedure, ruoli squadre, vie fuga, punti raccolta, comunicazioni, interfaccia soccorritori esterni."
            },
            {
                question: "Qual √® la periodicit√† delle prove di evacuazione?",
                options: [
                    "Mensile",
                    "Almeno annuale (semestrale consigliato)",
                    "Ogni 5 anni",
                    "Mai"
                ],
                correct: 1,
                explanation: "Buona prassi e norme: almeno 1 prova evacuazione all'anno (alcune norme consigliano ogni 6 mesi). Obbligatorio documentarle (verbali)."
            },
            {
                question: "Cosa deve contenere il Piano di Emergenza?",
                options: [
                    "Solo planimetrie",
                    "Planimetrie, procedure, squadre, mezzi estinzione, vie fuga, comunicazioni",
                    "Solo telefoni",
                    "Niente"
                ],
                correct: 1,
                explanation: "PEI deve contenere: planimetrie con vie fuga, procedure operative per scenario, ruoli squadre, mezzi antincendio/primo soccorso, comunicazioni interne/esterne."
            },
            {
                question: "Chi sono i 'Lavoratori particolarmente sensibili al rischio'?",
                options: [
                    "Solo disabili",
                    "Minori, gestanti, lavoratori con patologie, neo-assunti, lavoratori atipici",
                    "Solo anziani",
                    "Nessuno"
                ],
                correct: 1,
                explanation: "Art. 28 D.Lgs. 81/2008: DVR deve considerare lavoratrici gestanti, minori, differenze di genere, et√†, provenienza, tipologia contrattuale."
            },
            {
                question: "Quali tutele prevede il D.Lgs. 81/2008 per le lavoratrici gestanti?",
                options: [
                    "Nessuna",
                    "Valutazione rischi specifici + adibizione mansioni compatibili o astensione anticipata",
                    "Solo permessi",
                    "Solo dopo parto"
                ],
                correct: 1,
                explanation: "Art. 28 e Titolo VII + D.Lgs. 151/2001: divieto lavori faticosi/pericolosi, valutazione rischi (chimico, biologico, posturale), adibizione compatibile o astensione."
            },
            {
                question: "Cosa prevede la sorveglianza sanitaria per esposizione a rumore >85 dB(A)?",
                options: [
                    "Niente",
                    "Visita medica periodica + audiometria",
                    "Solo audiometria",
                    "Solo consegna DPI"
                ],
                correct: 1,
                explanation: "Art. 196 D.Lgs. 81/2008: sopra 85 dB(A) LEX √® obbligatoria sorveglianza sanitaria con esame audiometrico periodico (frequenza stabilita da medico competente)."
            },
            {
                question: "Qual √® il limite di esposizione giornaliera al rumore?",
                options: [
                    "80 dB(A)",
                    "85 dB(A)",
                    "87 dB(A) LEX (valori limite non superabili)",
                    "90 dB(A)"
                ],
                correct: 2,
                explanation: "Art. 189 D.Lgs. 81/2008: Valori limite: LEX,8h = 87 dB(A) e ppeak = 140 dB(C) NON devono essere superati (con DPI)."
            },
            {
                question: "A partire da quale valore di esposizione al rumore sono obbligatori i DPI uditivi?",
                options: [
                    "80 dB(A) - forniti",
                    "85 dB(A) - uso obbligatorio",
                    "90 dB(A)",
                    "Non obbligatori"
                ],
                correct: 1,
                explanation: "Art. 193: >80 dB forniti su richiesta; >85 dB uso obbligatorio + segnaletica + delimitazione aree. Verificare efficacia DPI affinch√© esposizione effettiva <87 dB."
            },
            {
                question: "Cosa si intende per 'vibrazioni mano-braccio'?",
                options: [
                    "Vibrazioni di tutto il corpo",
                    "Vibrazioni trasmesse al sistema mano-braccio da utensili vibranti",
                    "Solo freddo",
                    "Niente"
                ],
                correct: 1,
                explanation: "Vibrazioni HAV (Hand-Arm Vibration) trasmesse da utensili portatili (smerigliatrici, martelli, motoseghe) causano patologie vascolari/neurologiche (Titolo VIII Capo III)."
            },
            {
                question: "Qual √® il valore limite di esposizione alle vibrazioni mano-braccio?",
                options: [
                    "2,5 m/s¬≤ A(8)",
                    "5 m/s¬≤ A(8)",
                    "10 m/s¬≤",
                    "Non definito"
                ],
                correct: 1,
                explanation: "Art. 201 D.Lgs. 81/2008: Valore limite 5 m/s¬≤ A(8); Valore d'azione 2,5 m/s¬≤ A(8) per vibrazioni mano-braccio."
            },
            {
                question: "Cosa prevede il Titolo X del D.Lgs. 81/2008?",
                options: [
                    "Rumore",
                    "Esposizione ad agenti biologici",
                    "Movimentazione carichi",
                    "Incendi"
                ],
                correct: 1,
                explanation: "Il Titolo X disciplina la protezione da agenti biologici (virus, batteri, funghi, parassiti) classificati in 4 gruppi di rischio crescente."
            },
            {
                question: "Quali sono i gruppi di rischio degli agenti biologici?",
                options: [
                    "Solo 2 gruppi",
                    "Gruppo 1 (nessun rischio) ‚Üí Gruppo 4 (rischio elevato)",
                    "Solo gruppo 4",
                    "Non classificati"
                ],
                correct: 1,
                explanation: "All. XLVI D.Lgs. 81/08: Gruppo 1 (nessun rischio), Gruppo 2 (basso), Gruppo 3 (grave), Gruppo 4 (elevato rischio individuale/collettivo)."
            },
            {
                question: "Cosa prevede il registro degli esposti per agenti cancerogeni?",
                options: [
                    "Non esiste",
                    "Registro nominativo lavoratori esposti, conservato 40 anni dopo cessazione esposizione",
                    "Solo 10 anni",
                    "Solo per amianto"
                ],
                correct: 1,
                explanation: "Art. 243 D.Lgs. 81/2008: il datore di lavoro deve istituire registro esposti a cancerogeni/mutageni, conservato per almeno 40 anni dalla cessazione."
            },
            {
                question: "Qual √® la normativa specifica per l'amianto?",
                options: [
                    "Non esiste",
                    "Titolo IX Capo III D.Lgs. 81/2008 + Legge 257/1992 (divieto estrazione/commercio)",
                    "Solo leggi regionali",
                    "Solo per edilizia"
                ],
                correct: 1,
                explanation: "L. 257/1992 vieta estrazione/commercio amianto; D.Lgs. 81/08 (artt. 246-265) regolamenta bonifica/smaltimento con misure rigide e iscrizione Albo Gestori."
            },
            {
                question: "Chi pu√≤ effettuare bonifiche di amianto?",
                options: [
                    "Chiunque",
                    "Solo imprese iscritte categoria 10 Albo Gestori Ambientali con formazione specifica",
                    "Solo geometri",
                    "Solo vigili del fuoco"
                ],
                correct: 1,
                explanation: "Art. 212 D.Lgs. 152/2006: bonifiche amianto solo da imprese iscritte Albo categoria 10A/10B, con personale formato ex art. 259 D.Lgs. 81/08."
            },
            {
                question: "Cosa prevede il D.Lgs. 105/2015 (ex Seveso III)?",
                options: [
                    "Solo incendi",
                    "Controllo pericoli incidenti rilevanti connessi a sostanze pericolose",
                    "Solo trasporti",
                    "Niente"
                ],
                correct: 1,
                explanation: "D.Lgs. 105/2015 (Direttiva Seveso III) regolamenta stabilimenti con sostanze pericolose oltre soglie: obbligo Rapporto Sicurezza, Piano Emergenza Esterno, info popolazione."
            },
            {
                question: "Cosa si intende per 'incidente rilevante'?",
                options: [
                    "Qualsiasi infortunio",
                    "Evento (emissione, incendio, esplosione) con gravi conseguenze immediate/differite per salute/ambiente",
                    "Solo esplosioni",
                    "Solo in industrie"
                ],
                correct: 1,
                explanation: "Art. 3 D.Lgs. 105/2015: incidente rilevante √® un evento (emissione, incendio, esplosione) derivante da sviluppi incontrollati con gravi conseguenze per uomo/ambiente."
            },
            {
                question: "Qual √® la differenza tra sostanza pericolosa e preparato pericoloso?",
                options: [
                    "Nessuna",
                    "Sostanza = elemento chimico puro; Preparato/Miscela = combinazione di sostanze",
                    "Solo il nome",
                    "Solo la concentrazione"
                ],
                correct: 1,
                explanation: "Sostanza: elemento chimico o composto puro. Preparato/Miscela (Reg. CLP 1272/2008): miscela di 2+ sostanze (es. vernici, detergenti)."
            },
            {
                question: "Cosa prevede il Regolamento REACH?",
                options: [
                    "Solo etichettatura",
                    "Registrazione, Valutazione, Autorizzazione, Restrizione sostanze Chimiche (UE 1907/2006)",
                    "Solo trasporti",
                    "Niente"
                ],
                correct: 1,
                explanation: "REACH (Reg. CE 1907/2006): obbliga fabbricanti/importatori a registrare sostanze chimiche presso ECHA, valutarne rischi, comunicarli nella catena di approvvigionamento."
            },
            {
                question: "Cosa contiene la Scheda di Dati di Sicurezza (SDS)?",
                options: [
                    "Solo prezzo",
                    "16 sezioni con info su pericoli, manipolazione, stoccaggio, emergenze, smaltimento",
                    "Solo nome prodotto",
                    "Niente"
                ],
                correct: 1,
                explanation: "La SDS (obbligatoria per sostanze/miscele pericolose) ha 16 sezioni: identificazione, pericoli, composizione, primo soccorso, antincendio, stoccaggio, esposizione, propriet√†, smaltimento, trasporto, etc."
            },
            {
                question: "Quando √® obbligatoria la Scheda di Dati di Sicurezza?",
                options: [
                    "Mai",
                    "Per sostanze/miscele classificate pericolose, PBT/vPvB, autorizzazione REACH",
                    "Solo su richiesta",
                    "Solo per acidi"
                ],
                correct: 1,
                explanation: "Art. 31 Reg. REACH: SDS obbligatoria per sostanze/miscele pericolose (CLP), sostanze PBT/vPvB, soggette ad autorizzazione/restrizione REACH."
            },
            {
                question: "Cosa indica il pittogramma GHS02 (fiamma)?",
                options: [
                    "Esplosivo",
                    "Infiammabile (gas, aerosol, liquidi, solidi)",
                    "Tossico",
                    "Corrosivo"
                ],
                correct: 1,
                explanation: "GHS02 (fiamma) indica pericoli fisici: gas/aerosol/liquidi/solidi infiammabili, liquidi/solidi piroforici, autoriscaldanti, sostanze che a contatto con acqua sviluppano gas infiammabili."
            },
            {
                question: "Cosa indica il pittogramma GHS05 (corrosione)?",
                options: [
                    "Solo per metalli",
                    "Corrosivo per pelle/occhi e materiali",
                    "Solo irritante",
                    "Infiammabile"
                ],
                correct: 1,
                explanation: "GHS05 indica sostanze corrosive: gravi ustioni cutanee/danni oculari (cat. 1), corrosione metalli. Es: acidi/basi forti."
            },
            {
                question: "Qual √® la differenza tra pericolo H e consiglio P nelle etichette CLP?",
                options: [
                    "Nessuna",
                    "H = Hazard (indicazioni pericolo); P = Precautionary (consigli prudenza)",
                    "Solo codici numerici",
                    "Solo per trasporti"
                ],
                correct: 1,
                explanation: "Reg. CLP 1272/2008: frasi H (Hazard statements) descrivono natura pericolo (es. H225 liquido infiammabile); frasi P (Precautionary) indicano misure di prudenza."
            },
            {
                question: "Cosa si intende per 'incompatibilit√† chimica'?",
                options: [
                    "Prodotti che non si mescolano",
                    "Sostanze che reagiscono pericolosamente tra loro (incendio, esplosione, gas tossici)",
                    "Solo differenti pH",
                    "Niente"
                ],
                correct: 1,
                explanation: "Incompatibilit√† chimica: sostanze che a contatto possono causare reazioni pericolose (es. acidi+basi, ossidanti+riducenti). Richiedono stoccaggio separato."
            },
            {
                question: "Quali sostanze non vanno MAI stoccate insieme?",
                options: [
                    "Tutte possono stare insieme",
                    "Acidi/basi, ossidanti/riducenti, infiammabili/comburenti, tossici/alimentari",
                    "Solo liquidi e solidi",
                    "Nessuna regola"
                ],
                correct: 1,
                explanation: "Separare sempre: acidi da basi forti, ossidanti da riducenti/infiammabili, comburenti da combustibili, tossici da alimenti, incompatibili chimicamente."
            },
            {
                question: "Cosa prevede il bacino di contenimento per liquidi pericolosi?",
                options: [
                    "Non serve",
                    "Capacit√† ‚â•110% volume contenitore maggiore o ‚â•25% volume totale stoccato",
                    "Solo per grandi quantit√†",
                    "Solo su richiesta"
                ],
                correct: 1,
                explanation: "Norme tecniche prevenzione: bacini di contenimento devono contenere almeno 110% del contenitore maggiore (o 100%+50% altri) per evitare dispersione sversamenti."
            },
            {
                question: "Qual √® la temperatura di infiammabilit√† (flash point)?",
                options: [
                    "Temperatura di combustione",
                    "Temperatura minima a cui vapori formano miscela infiammabile con aria",
                    "Temperatura massima",
                    "Temperatura ambiente"
                ],
                correct: 1,
                explanation: "Flash point (punto di infiammabilit√†): temperatura minima alla quale un liquido emette vapori sufficienti a formare miscela infiammabile con aria in presenza di innesco."
            },
            {
                question: "Cosa si intende per 'LEL' e 'UEL'?",
                options: [
                    "Niente",
                    "Lower/Upper Explosion Limit = limiti inferiore/superiore esplosivit√† gas",
                    "Solo per liquidi",
                    "Temperature"
                ],
                correct: 1,
                explanation: "LEL (Lower Explosion Limit): concentrazione minima gas/vapore infiammabile in aria per esplodere. UEL (Upper): concentrazione massima. Tra LEL-UEL = campo esplosivit√†."
            },
            {
                question: "Quale tipo di estintore va usato su fuochi di classe D (metalli)?",
                options: [
                    "A polvere ABC",
                    "Estintore specifico per metalli (polvere speciale o sabbia secca)",
                    "Ad acqua",
                    "CO2"
                ],
                correct: 1,
                explanation: "Fuochi classe D (metalli combustibili: Mg, Al, Na, K): richiedono polveri speciali (es. grafite, carbonato sodico seccato) o sabbia secca. MAI acqua (reazione violenta)."
            },
            {
                question: "Quando si usa un estintore a CO2?",
                options: [
                    "Su tutto",
                    "Fuochi classe B (liquidi) e rischi elettrici (non conduttivo)",
                    "Solo su legno",
                    "Mai"
                ],
                correct: 1,
                explanation: "CO2: ideale per fuochi classe B (liquidi infiammabili), classe C (gas), apparecchiature elettriche (non conduttivo, non lascia residui). Non su classe A (poco efficace)."
            },
            {
                question: "Cosa prevede la gestione dei rifiuti pericolosi?",
                options: [
                    "Come normali rifiuti",
                    "Deposito temporaneo separato, etichettatura, registro carico/scarico, FIR, smaltimento tramite trasportatori autorizzati",
                    "Solo in discarica",
                    "Nessuna regola"
                ],
                correct: 1,
                explanation: "D.Lgs. 152/2006: rifiuti pericolosi vanno segregati, etichettati (CER), stoccati in aree idonee, registrati (reg. C/S), smaltiti con FIR tramite gestori autorizzati."
            }
        ];

        // ========================================
        // STATO APPLICAZIONE
        // ========================================
        let selectedQuestions = [];
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let timer = null;
        let timeRemaining = TEST_DURATION;

        // ========================================
        // FUNZIONI UTILITY
        // ========================================
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // ========================================
        // START QUIZ
        // ========================================
        function startQuiz() {
            // Seleziona 15 domande casuali
            selectedQuestions = shuffleArray(questionBank).slice(0, TEST_QUESTIONS);
            
            // Reset stato
            currentQuestionIndex = 0;
            userAnswers = new Array(TEST_QUESTIONS).fill(null);
            timeRemaining = TEST_DURATION;

            // Cambia schermata
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('quizScreen').classList.remove('hidden');

            // Genera minimap
            generateMinimap();

            // Mostra prima domanda
            showQuestion(0);

            // Avvia timer
            startTimer();
        }

        // ========================================
        // TIMER
        // ========================================
        function startTimer() {
            timer = setInterval(() => {
                timeRemaining--;
                
                const timerEl = document.getElementById('timer');
                timerEl.textContent = formatTime(timeRemaining);

                // Warning ultimi 2 minuti
                if (timeRemaining <= 120 && timeRemaining > 0) {
                    timerEl.classList.add('timer-warning', 'text-red-600');
                }

                // Tempo scaduto
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    endQuiz();
                }
            }, 1000);
        }

        // ========================================
        // MINIMAP
        // ========================================
        function generateMinimap() {
            const minimap = document.getElementById('minimap');
            minimap.innerHTML = '';

            for (let i = 0; i < TEST_QUESTIONS; i++) {
                const btn = document.createElement('button');
                btn.className = 'minimap-item w-10 h-10 rounded flex items-center justify-center text-sm font-semibold transition-all';
                btn.textContent = i + 1;
                btn.onclick = () => showQuestion(i);
                
                updateMinimapItem(btn, i);
                minimap.appendChild(btn);
            }
        }

        function updateMinimapItem(btn, index) {
            if (userAnswers[index] !== null) {
                btn.className = 'minimap-item w-10 h-10 rounded flex items-center justify-center text-sm font-semibold bg-blue-500 text-white hover:bg-blue-600';
            } else {
                btn.className = 'minimap-item w-10 h-10 rounded flex items-center justify-center text-sm font-semibold bg-gray-200 text-gray-700 hover:bg-gray-300';
            }
        }

        function updateAllMinimapItems() {
            const buttons = document.querySelectorAll('#minimap button');
            buttons.forEach((btn, index) => {
                updateMinimapItem(btn, index);
            });
        }

        // ========================================
        // DISPLAY QUESTION
        // ========================================
        function showQuestion(index) {
            currentQuestionIndex = index;
            const question = selectedQuestions[index];

            // Update header
            document.getElementById('currentQ').textContent = index + 1;
            document.getElementById('questionNumber').textContent = index + 1;
            document.getElementById('progressPercent').textContent = Math.round((index / TEST_QUESTIONS) * 100) + '%';
            document.getElementById('progressBar').style.width = ((index / TEST_QUESTIONS) * 100) + '%';

            // Update question text
            document.getElementById('questionText').textContent = question.question;

            // Generate options
            const container = document.getElementById('optionsContainer');
            container.innerHTML = '';

            question.options.forEach((option, optIndex) => {
                const btn = document.createElement('button');
                btn.className = 'option-button w-full text-left p-4 rounded-xl border-2 border-gray-200 hover:border-purple-400 font-medium';
                
                const letter = String.fromCharCode(65 + optIndex); // A, B, C, D
                btn.innerHTML = `
                    <span class="inline-block w-8 h-8 rounded-full bg-gray-100 text-center leading-8 mr-3 font-bold text-gray-600">
                        ${letter}
                    </span>
                    <span>${option}</span>
                `;

                btn.onclick = () => answerQuestion(optIndex);
                container.appendChild(btn));
            });
        }

        // ========================================
        // ANSWER QUESTION
        // ========================================
        function answerQuestion(optionIndex) {
            // Salva risposta
            user
Answers[currentQuestionIndex] = optionIndex;

            // Aggiorna minimap
            updateAllMinimapItems();

            // Avanza automaticamente alla domanda successiva
            if (currentQuestionIndex < TEST_QUESTIONS - 1) {
                setTimeout(() => {
                    showQuestion(currentQuestionIndex + 1);
                }, 300);
            } else {
                // Ultima domanda - mostra pulsante termina
                setTimeout(() => {
                    if (confirm('Hai risposto a tutte le domande. Vuoi terminare il quiz?')) {
                        endQuiz();
                    }
                }, 300);
            }
        }

        // ========================================
        // END QUIZ
        // ========================================
        function endQuiz() {
            clearInterval(timer);

            // Calcola risultati
            let correctCount = 0;
            const results = selectedQuestions.map((q, index) => {
                const isCorrect = userAnswers[index] === q.correct;
                if (isCorrect) correctCount++;

                return {
                    question: q.question,
                    userAnswer: userAnswers[index] !== null ? q.options[userAnswers[index]] : 'Non risposto',
                    correctAnswer: q.options[q.correct],
                    isCorrect: isCorrect,
                    explanation: q.explanation
                };
            });

            const score = Math.round((correctCount / TEST_QUESTIONS) * 100);
            const passed = score >= PASSING_SCORE;

            // Salva in localStorage
            saveResults({
                date: new Date().toISOString(),
                score: score,
                correct: correctCount,
                total: TEST_QUESTIONS,
                passed: passed,
                timeUsed: TEST_DURATION - timeRemaining,
                results: results
            });

            // Mostra schermata risultati
            showResults(score, correctCount, passed, results);
        }

        // ========================================
        // SHOW RESULTS
        // ========================================
        function showResults(score, correctCount, passed, results) {
            document.getElementById('quizScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('hidden');

            // Update score display
            document.getElementById('finalScore').textContent = score;
            document.getElementById('correctCount').textContent = correctCount;
            document.getElementById('wrongCount').textContent = TEST_QUESTIONS - correctCount;

            // Status message
            const statusEl = document.getElementById('resultStatus');
            const statusMsgEl = document.getElementById('resultMessage');
            
            if (passed) {
                statusEl.innerHTML = `
                    <div class="w-24 h-24 mx-auto mb-4 rounded-full bg-green-100 flex items-center justify-center">
                        <svg class="w-12 h-12 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <h2 class="text-3xl font-bold text-green-600 mb-2">SUPERATO!</h2>
                `;
                statusMsgEl.textContent = `Complimenti! Hai dimostrato ottima conoscenza della sicurezza in magazzino.`;
            } else {
                statusEl.innerHTML = `
                    <div class="w-24 h-24 mx-auto mb-4 rounded-full bg-red-100 flex items-center justify-center">
                        <svg class="w-12 h-12 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </div>
                    <h2 class="text-3xl font-bold text-red-600 mb-2">NON SUPERATO</h2>
                `;
                statusMsgEl.textContent = `Purtroppo non hai raggiunto il punteggio minimo. Studia le lezioni e riprova!`;
            }

            // Generate detailed results
            const detailsContainer = document.getElementById('detailedResults');
            detailsContainer.innerHTML = '';

            results.forEach((result, index) => {
                const div = document.createElement('div');
                div.className = `p-6 rounded-xl border-2 ${result.isCorrect ? 'bg-green-50 border-green-300' : 'bg-red-50 border-red-300'}`;
                
                div.innerHTML = `
                    <div class="flex items-start justify-between mb-3">
                        <h3 class="font-bold text-lg flex-1">
                            <span class="text-gray-500">Domanda ${index + 1}:</span> ${result.question}
                        </h3>
                        <span class="ml-4 flex-shrink-0">
                            ${result.isCorrect 
                                ? '<svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'
                                : '<svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>'
                            }
                        </span>
                    </div>
                    
                    <div class="space-y-2 text-sm">
                        <p>
                            <span class="font-semibold ${result.isCorrect ? 'text-green-700' : 'text-red-700'}">Tua risposta:</span>
                            <span class="ml-2">${result.userAnswer}</span>
                        </p>
                        ${!result.isCorrect ? `
                            <p>
                                <span class="font-semibold text-green-700">Risposta corretta:</span>
                                <span class="ml-2">${result.correctAnswer}</span>
                            </p>
                        ` : ''}
                        <div class="mt-3 pt-3 border-t ${result.isCorrect ? 'border-green-200' : 'border-red-200'}">
                            <p class="font-semibold mb-1">üí° Spiegazione:</p>
                            <p class="text-gray-700">${result.explanation}</p>
                        </div>
                    </div>
                `;
                
                detailsContainer.appendChild(div);
            });
        }

        // ========================================
        // SAVE RESULTS TO LOCALSTORAGE
        // ========================================
        function saveResults(result) {
            let history = JSON.parse(localStorage.getItem('quizHistory') || '[]');
            history.unshift(result);
            
            // Mantieni solo ultimi 10 tentativi
            if (history.length > 10) {
                history = history.slice(0, 10);
            }
            
            localStorage.setItem('quizHistory', JSON.stringify(history));
        }

        // ========================================
        // RESET QUIZ
        // ========================================
        function resetQuiz() {
            clearInterval(timer);
            
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('welcomeScreen').classList.remove('hidden');
            
            // Reset variables
            selectedQuestions = [];
            currentQuestionIndex = 0;
            userAnswers = [];
            timeRemaining = TEST_DURATION;
        }

        // ========================================
        // EXPORT RESULTS AS PDF
        // ========================================
        function exportResults() {
            // Semplice implementazione con window.print()
            // Per PDF avanzato si pu√≤ integrare jsPDF
            const printWindow = window.open('', '_blank');
            const resultsHTML = document.getElementById('resultsScreen').innerHTML;
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Risultati Quiz - Rischi in Magazzino</title>
                    <script src="https://cdn.tailwindcss.com"></script>
                    <style>
                        @media print {
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body class="p-8">
                    <div class="max-w-4xl mx-auto">
                        <h1 class="text-2xl font-bold mb-4">Quiz Rischi Specifici in Magazzino</h1>
                        <p class="mb-2"><strong>Data:</strong> ${new Date().toLocaleDateString('it-IT')}</p>
                        <p class="mb-6"><strong>Docente:</strong> Dott. Salvatore Trono</p>
                        ${resultsHTML}
                    </div>
                    <script>
                        window.onload = () => {
                            window.print();
                        };
                    </script>
                </body>
                </html>
            `);
            
            printWindow.document.close();
        }

        // ========================================
        // VIEW HISTORY
        // ========================================
        function viewHistory() {
            const history = JSON.parse(localStorage.getItem('quizHistory') || '[]');
            
            if (history.length === 0) {
                alert('Nessun tentativo precedente trovato.');
                return;
            }

            let historyHTML = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onclick="this.remove()">
                    <div class="bg-white rounded-2xl max-w-3xl w-full max-h-[90vh] overflow-auto p-6" onclick="event.stopPropagation()">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">üìä Storico Tentativi</h2>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        
                        <div class="space-y-4">
            `;

            history.forEach((attempt, index) => {
                const date = new Date(attempt.date);
                const passed = attempt.passed;
                
                historyHTML += `
                    <div class="p-4 rounded-xl border-2 ${passed ? 'bg-green-50 border-green-300' : 'bg-red-50 border-red-300'}">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="font-bold text-lg">Tentativo #${history.length - index}</p>
                                <p class="text-sm text-gray-600">${date.toLocaleString('it-IT')}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-3xl font-bold ${passed ? 'text-green-600' : 'text-red-600'}">${attempt.score}%</p>
                                <p class="text-sm">${attempt.correct}/${attempt.total} corrette</p>
                            </div>
                        </div>
                        <div class="mt-3 pt-3 border-t ${passed ? 'border-green-200' : 'border-red-200'}">
                            <p class="text-sm">
                                <strong>Tempo impiegato:</strong> ${Math.floor(attempt.timeUsed / 60)}:${(attempt.timeUsed % 60).toString().padStart(2, '0')}
                            </p>
                            <p class="text-sm font-semibold ${passed ? 'text-green-600' : 'text-red-600'}">
                                ${passed ? '‚úì SUPERATO' : '‚úó NON SUPERATO'}
                            </p>
                        </div>
                    </div>
                `;
            });

            historyHTML += `
                        </div>
                        <div class="mt-6 text-center">
                            <button onclick="if(confirm('Vuoi cancellare tutto lo storico?')) { localStorage.removeItem('quizHistory'); this.closest('.fixed').remove(); }" 
                                    class="px-6 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">
                                üóëÔ∏è Cancella Storico
                            </button>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', historyHTML);
        }

        // ========================================
        // EVENT LISTENERS
        // ========================================
        document.getElementById('startBtn').addEventListener('click', startQuiz);
        document.getElementById('retryBtn').addEventListener('click', resetQuiz);
        document.getElementById('exportBtn').addEventListener('click', exportResults);
        document.getElementById('homeBtn').addEventListener('click', resetQuiz);
        document.getElementById('viewHistoryBtn').addEventListener('click', viewHistory);

        // Previeni chiusura accidentale durante quiz
        window.addEventListener('beforeunload', (e) => {
            if (timer !== null) {
                e.preventDefault();
                e.returnValue = '';
            }
        });
    </script>
</body>
</html>

